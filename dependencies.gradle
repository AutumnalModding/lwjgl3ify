
minecraft {
    lwjglVersion.set("3.3.1")
}

// Swap out asm for a newer version for testing in development
def useNewAsm = true
def addGtForTesting = true

dependencies {
    // Resolve newer versions of LaunchWrapper to allow java 9+ compat
    vanilla_minecraft('net.minecraft:launchwrapper:1.13') { transitive = false }
    patchedMinecraft('net.minecraft:launchwrapper:1.13') { transitive = false }

    if (useNewAsm) {
        patchedMinecraft('org.ow2.asm:asm:9.4')
        patchedMinecraft('org.ow2.asm:asm-commons:9.4')
        patchedMinecraft('org.ow2.asm:asm-tree:9.4')
        patchedMinecraft('org.ow2.asm:asm-analysis:9.4')
        patchedMinecraft('org.ow2.asm:asm-util:9.4')
        patchedMinecraft('org.ow2.asm:asm-deprecated:7.1')
    }

    shadowImplementation("jakarta.xml.bind:jakarta.xml.bind-api:3.0.1")
    shadowImplementation("com.sun.xml.bind:jaxb-impl:3.0.2")

    annotationProcessor('com.gtnewhorizon:gtnhmixins:2.1.8:processor')
    implementation('com.gtnewhorizon:gtnhmixins:2.1.8')

    if (addGtForTesting) {
        runtimeOnly('com.github.GTNewHorizons:GT5-Unofficial:5.09.41.218:dev')
        runtimeOnly("com.github.GTNewHorizons:Applied-Energistics-2-Unofficial:rv3-beta-142-GTNH:dev")
        runtimeOnly("com.github.GTNewHorizons:Chisel:2.10.16-GTNH:dev")
        runtimeOnly("com.github.GTNewHorizons:ForestryMC:4.5.6:dev")
        runtimeOnly("com.github.GTNewHorizons:Railcraft:9.13.14:dev")
        runtimeOnly("com.github.GTNewHorizons:EnderIO:2.3.1.49:dev")
        runtimeOnly("com.github.GTNewHorizons:ProjectRed:4.7.9-GTNH:dev") { transitive = false }
        runtimeOnly("com.github.GTNewHorizons:MrTJPCore:1.1.4:dev")
        runtimeOnly("com.github.GTNewHorizons:ForgeMultipart:1.3.1:dev")
        runtimeOnly("com.github.GTNewHorizons:ForgeRelocation:0.0.3:dev")
        reobfJarConfiguration group: 'curse.maven', name: 'cofh-core-69162', version: '2388750'
        runtimeOnly("com.github.GTNewHorizons:AppleCore:3.2.6-pre:dev")
    }
}

minecraft {
    groupsToExcludeFromAutoReobfMapping.add('curse.maven')
}

if (useNewAsm) {
    configurations.patchedMinecraft {
        exclude group: 'org.ow2.asm', module: 'asm-debug-all'
    }
}
